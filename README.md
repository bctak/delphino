# C_static_analysis

# The project to analyze C code and extract system calls used by the program
## Overview
This project extracts libc functions using Clang and libc symbols, identifies the relationship between libc functions and system calls, and ultimately extracts system calls from C code. In the future, system call information can be used for security, program structure analysis, and other purposes.

## Getting Started

### Prerequisites

- **Clang:** Clang must be installed on the PC to analyze C code.
```
sudo apt update
sudo apt install clang
```

- **Graphviz:** Graphviz must be installed in order to generate the graph.
```
sudo apt update
sudo apt install python3-pip
pip install graphviz
```

### Usage

#### 1. Static analysis program ( not completed )

```
cd C_static_analysis/src/
python3 static_analysis.py [-g] [-m] [-o file_name] [c source code name]
```
The -g option visually converts the call graph and generates it as a PDF file.
- A PDF file is generated for each user-defined function in the C code, including main. However, if a function does not contain any calls to other functions, no PDF file is created for it.

The -m option generates a single graph that combines all function call flows in the code and outputs it as a PDF file.
- Creates a single PDF graph that visualizes all function call flows within one code file.

If you use the -o option along with a file name, you can specify the output file name for the graph generated by the -m option.
- If the -o option is not used, the file name for the graph generated with the -m option will default to FINAL_GRAPH.

##### Example
```
cd C_static_analysis/example/
python3 static_analysis.py -m simple_test.c
```

#### 2. Program that converts glibc functions to system calls.

```
cd C_static_analysis/src/
python3 glibc_syscall.py [-l] [-o {json,plain}] [call graph file name] [glibc function name] 
```
The -l option print all glibc functions and exit
- There is no need to specify the call graph file name and glibc function name.

The -o option specifies the output format to be displayed
- json or plain (default plain)

The call graph file name refers to a file in the callgraph directory
- This uses the call graph generated by c2c (https://github.com/shamedgh/c2c).
- Other call graphs with the same format can also be used

The glibc function name specifies the name of the glibc function to be converted into system calls

##### Example
```
cd C_static_analysis/example/
python3 glibc_syscall.py -o json glibc.callgraph printf 
```

#### 3. Program to extract glibc functions used in C code

```
cd C_static_analysis/src/
python3 extract_glibc.py [c source code name]
```
Pass the filename of the C code to be analyzed as the first argument. As a result, the glibc functions used in the C code will be displayed.

##### Example
```
cd C_static_analysis/example/
python3 extract_glibc.py dirtycred.c
```

## Project Structure
```
Syscall_sequence_defense/
│
├── src/
│   ├── static_analysis.py                  # C language analysis program
│   ├── glibc_syscall.py                    # A program converting glibc functions to system calls.
│   ├── extract_glibc.py                    # Extract glibc functions used in C code
│
├── example/
│   ├── static_analysis.py                  # C language analysis program
│   ├── glibc_syscall.py                    # A program converting glibc functions to system calls.
│   ├── extract_glibc.py                    # Extract glibc functions used in C code
│   ├── dirtycred.c                         # Example C code (Dirty Cred attack code)
│   ├── glibc.2.23.callgraph                # glibc call graph
│   ├── glibc.2.31.callgraph                # glibc call graph
│   ├── glibc.callgraph                     # glibc call graph
│
├── callgraph/
│   ├── glibc.2.23.callgraph                # glibc call graph
│   ├── glibc.2.31.callgraph                # glibc call graph
│   ├── glibc.callgraph                     # glibc call graph
│
└── README.md                               # Project README file
```
